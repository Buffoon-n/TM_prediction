data<-read.table("k_setup_packet_count.dat",header=T,sep="\t")
max_x <- max(data$k)
min_x <- min(data$k)
max_y <- max(data$e03n6, data$e03n8, data$e03n10,data$e12n4, data$e12n6, data$e12n8, data$e20n4, data$e20n6, data$e20n8)
min_y <- min(data$e03n6, data$e03n8, data$e03n10,data$e12n4, data$e12n6, data$e12n8, data$e20n4, data$e20n6, data$e20n8)
max_e <- max(data$xi03n6, data$xi03n8, data$xi03n10, data$xi12n4, data$xi12n6, data$xi12n8, data$xi20n4, data$xi20n6, data$xi20n8)
setEPS()
postscript("k_setup_packet_count.eps",height=5, width=4.5)
par(mar=c(5, 5, 1, 1) + 0.1)
par(mgp = c(3, 1, 0))

plot_colors <-  c("dodgerblue4", "red", "darkorange4")

plot(c(min_x,max_x),c(min_y,max_y+10000), type="n", cex.lab = 1.5, cex.axis=1.5, xlab="Number of core polygons", ylab="Total hop counts of control packets")
#axis(1,cex.axis = 1.25)
#axis(2,cex.axis = 1.25)
lines(data$k, data$e03n6, type="o", pch=0, lty=2, col=plot_colors[1], lwd=1.5)
lines(data$k, data$e03n8, type="o", pch=0, lty=3, col=plot_colors[1], lwd=1.5)
lines(data$k, data$e03n10, type="o", pch=0, lty=4, col=plot_colors[1], lwd=1.5)
lines(data$k, data$e12n4, type="o", pch=1, lty=1, col=plot_colors[2], lwd=1.5)
lines(data$k, data$e12n6, type="o", pch=1, lty=2, col=plot_colors[2], lwd=1.5)
lines(data$k, data$e12n8, type="o", pch=1, lty=3, col=plot_colors[2], lwd=1.5)
lines(data$k, data$e20n4, type="o", pch=2, lty=1, col=plot_colors[3], lwd=1.5)
lines(data$k, data$e20n6, type="o", pch=2, lty=2, col=plot_colors[3], lwd=1.5)
lines(data$k, data$e20n8, type="o", pch=2, lty=3, col=plot_colors[3], lwd=1.5)

arrows(x0=data$k, y0=data$e03n6-data$xi03n6, x1=data$k, y1= data$e03n6+data$xi03n6, code=3, angle=90, length = 0.05, col=plot_colors[1])
arrows(x0=data$k, y0=data$e03n8-data$xi03n8, x1=data$k, y1= data$e03n8+data$xi03n8, code=3, angle=90, length = 0.05, col=plot_colors[1])
arrows(x0=data$k, y0=data$e03n10-data$xi03n10, x1=data$k, y1= data$e03n10+data$xi03n10, code=3, angle=90, length = 0.05, col=plot_colors[1])
arrows(x0=data$k, y0=data$e12n4-data$xi12n4, x1=data$k, y1= data$e12n4+data$xi12n4, code=3, angle=90, length = 0.05, col=plot_colors[2])
arrows(x0=data$k, y0=data$e12n6-data$xi12n6, x1=data$k, y1= data$e12n6+data$xi12n6, code=3, angle=90, length = 0.05, col=plot_colors[2])
arrows(x0=data$k, y0=data$e12n8-data$xi12n8, x1=data$k, y1= data$e12n8+data$xi12n8, code=3, angle=90, length = 0.05, col=plot_colors[2])
arrows(x0=data$k, y0=data$e20n4-data$xi20n4, x1=data$k, y1= data$e20n4+data$xi20n4, code=3, angle=90, length = 0.05, col=plot_colors[3])
arrows(x0=data$k, y0=data$e20n6-data$xi20n6, x1=data$k, y1= data$e20n6+data$xi20n6, code=3, angle=90, length = 0.05, col=plot_colors[3])
arrows(x0=data$k, y0=data$e20n8-data$xi20n8, x1=data$k, y1= data$e20n8+data$xi20n8, code=3, angle=90, length = 0.05, col=plot_colors[3])

#legend("topright",inset=c(-0.42,0), c(expression(paste(epsilon==0.8, ", ", n==4)),expression(paste(epsilon==0.8, ", ", n==5)),expression(paste(epsilon==0.8, ", ", n==6)),expression(paste(epsilon==0.8, ", ", n==8)),expression(paste(epsilon==1.5, ", ", n==4)),expression(paste(epsilon==1.5, ", ", n==5)),expression(paste(epsilon==1.5, ", ", n==6)),expression(paste(epsilon==1.5, ", ", n==8)) ),pch=c(0,1,2,4,6,8,5,10), lty=c(1,2,3,4,1,2,3,4), col=plot_colors, cex=1.5, xjust=0.5, yjust=0.5, ncol=1)

#lines(data$n, data$n17, type="o", pch=5, lty=1, col=plot_colors[7], lwd=1.5)
#lines(data$n, data$n20, type="o", pch=10, lty=2, col=plot_colors[8], lwd=1.5)
#legend("topleft",c("e=0.3","e=0.5","e=0.7","e=1.0","e=1.3","e=1.5","e=1.7","e=2.0"),pch=c(0,1,2,4,6,8,5,10), lty=c(1,2,3,4,5,6,1,2), col=plot_colors, cex=1.2)
dev.off()
